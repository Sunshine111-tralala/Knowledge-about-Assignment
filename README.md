# Knowledge-about-Assignment
Using Racket language to discuss the effect and side-effect of assignment 

## 关于赋值所产生的副作用罗列
1. 对我们的类型系统带来冲击（在引入赋值之前，类型系统我们是可以简单的看作集合论的应用的）；
2. 并发带来的死锁等问题；
3. 引入了状态，导致我们无法简单地把相等的值和相同的值看作一个概念，因为现在相等的东西，之后可能会有一方发生变化，从而破坏这个相等关系；

### 关于其对于类型系统所造成的困扰，举例如下：
`` '(1 2 3 4)``的类型，是``(Listof Natral)``，同样也可以是``(Listof Real)``。则下列代码块是正确的：
``` Racket
(: ls (Listof Natural))
(define ls '(1 2 3 4))

(ann ls (Listof Real))
```

如果引入了赋值，则如果下列的代码段
``` Racket
(: ls (MListof Natural))
(define ls (mlist 1 2 3 4))

(ann ls (MListof Real))
```
正确的话,会导致什么样的问题出现呢？

如果把``ls``中的一个元素换成是``Real``而非``Natural``类型，则会与第一行的关于``ls``的声明``(MListof Natural)``相冲突。

从集合的角度来看类型的话，显然 ``(MListof Real)`` 包含所有的 ``(MListof Natural) ``可是引入了赋值之后，把二者看作父子类型关系的话，就出现了矛盾。
于是，所有的可以赋值的数据结构，都被分裂成了两种类型 -- Mutable 和 Immutable。

一方面，我们语言的类型极大的增加了，另一方面，面对这些 Mutable 的数据，我们不能用集合的角度去思考问题了。
这都给我们的心智造成了负担，也给我们语言的一些功能实现造成了负担 -- 比如说在现在的 Typed Racket 里面，Mutable 的数据一般是不能用 ``define-predicate`` 生成 ``predicate`` 的。

### 关于引入状态后无法将相等的之和相同的值看作一个概念的问题

在此处我们通过花名册来对问题进行一些说明：

假如一班有一些老师，教师花名册如下：
```
职位名称 -- 职工名称 -- 职工工资
数学老师 -- 王 -- 10000
语文老师 -- 李 -- 12000
英语老师 -- 董 -- 11000
```

现在要临时成立一个外语辅导班，外语辅导班有一个职位叫做 外语老师 是空缺的，于是就请一班的英语老师来担任辅导班的外语老师。

那么辅导班的花名册如下：
```
外语老师 -- 董 -- 11000
```

这一系列流程都没有问题，但是，假如现在引入人员变动，会发生什么情况呢？
比如说现在一班的英语老师换成了赵老师，那么辅导班的外语老师还是董老师吗？

准确的来讲，引入人员变动之后，歧义就产生了：引入赋值之后，我们并不清楚函数调用时，形参绑定的到底是什么。

具体的代码表示为：
``` Racket
(define 英文老师 '董老师)
(define 新花名册
  (λ (外文老师)
    (λ ()
      外文老师)))

(define 辅导班花名册 (新花名册 英文老师))
(displayln (辅导班花名册))

(set! 英文老师 '赵老师)
(displayln (辅导班花名册))
```

在 PL 里面，variable name 对应的就是例子里的 职工姓名，Object 对应的就是 职工名称 -- 职工工资。

从上面的问题我们看到，在没有引入赋值之前，我们只需要思考 variable 和 Object 之间的联系就好了。
但是引入了赋值之后，只思考 variable 和 Object 就会引入歧义。
在花名册的例子里面，为了取消这个歧义，于是就扩展了花名册：

```
职位名称 -- 职位编号 -- 职工名称 -- 职工工资 -- 职工身份证号
数学老师 -- r1 -- 王 -- 10000 -- v1
语文老师 -- r2 -- 李 -- 12000 -- v2
英语老师 -- r3 -- 董 -- 11000 -- v3
```

和PL的对应：
```
Variable name -- 职位名称
Reference -- 职位编号
Object -- 职工名称，职工工资
Value -- 职工身份证号
```

此处对于函数的参数传递方式进行介绍：
1. call by value: 代表语言是C语言，对应的例子是：辅导班花名册的构成过程由在校外找了一个新的人当作外文老师，这个人姓董，工资为11000(Object与v3的Object相同)，但是他是一个新的人，有着新的身份证号(v4)，同样其职位编号也是新的(r4)；
2. call by object:代表语言是Scheme、Java、Python。其对应的例子是：辅导班直接让v3当外文老师r4。
3. call by reference：对应的例子是辅导班外文老师的职位和英文老师的职位都是r3,但关于同一职位有着不同的名称，一个“叫”英文老师，另一个“叫”外文老师。

赋值修改的就是Reference和Value之间的关系；

